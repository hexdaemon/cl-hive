# =============================================================================
# Fluent Bit Parsers for cl-hive
# =============================================================================

# Supervisor logs
[PARSER]
    Name        supervisor
    Format      regex
    Regex       ^(?<time>\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2},\d{3}) (?<level>\w+) (?<message>.*)$
    Time_Key    time
    Time_Format %Y-%m-%d %H:%M:%S,%L

# Core Lightning daemon logs (standard format)
[PARSER]
    Name        lightningd
    Format      regex
    Regex       ^(?<time>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z) (?<level>\w+) (?<plugin>[\w-]+): (?<message>.*)$
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ

# Core Lightning JSON logs (when using log-level=io)
[PARSER]
    Name        lightningd_json
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ

# Tor logs
[PARSER]
    Name        tor
    Format      regex
    Regex       ^(?<time>[A-Z][a-z]{2} \d{2} \d{2}:\d{2}:\d{2}\.\d{3}) \[(?<level>\w+)\] (?<message>.*)$
    Time_Key    time
    Time_Format %b %d %H:%M:%S.%L

# cl-hive plugin logs (Python logging format)
[PARSER]
    Name        cl_hive
    Format      regex
    Regex       ^(?<time>\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) \[(?<level>\w+)\] \[(?<module>[\w.]+)\] (?<message>.*)$
    Time_Key    time
    Time_Format %Y-%m-%d %H:%M:%S

# cl-revenue-ops plugin logs
[PARSER]
    Name        cl_revenue_ops
    Format      regex
    Regex       ^(?<time>\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) \[(?<level>\w+)\] \[revenue-ops\] (?<message>.*)$
    Time_Key    time
    Time_Format %Y-%m-%d %H:%M:%S

# Generic syslog-style
[PARSER]
    Name        syslog
    Format      regex
    Regex       ^(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[a-zA-Z0-9_\/\.\-]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? *(?<message>.*)$
    Time_Key    time
    Time_Format %b %d %H:%M:%S

# Docker JSON logs
[PARSER]
    Name        docker
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ
    Time_Keep   On
